/*
 * capt_seq.c - auto-generated by CHDK code_gen.
 */
#include "lolevel.h"
#include "platform.h"
#include "core.h"

#define NR_AUTO (0)                 // have to explictly reset value back to 0 to enable auto
static long *nrflag = (long*)(0xa0e0); // found by trial and error near 0xa0dc referenced near 0xffa1efb4 (0xa0dc + 0x4)
//#define PAUSE_FOR_FILE_COUNTER 200  // Enable delay in capt_seq_hook_raw_here to ensure file counter is updated

#include "../../../generic/capt_seq.c"

/*************************************************************/
//** capt_seq_task @ 0xFF88931C - 0xFF8895F4, length=183
void __attribute__((naked,noinline)) capt_seq_task() {
asm volatile (
"    STMFD   SP!, {R3-R7,LR} \n"
"    LDR     R5, =0x1C3E4 \n"
"    LDR     R7, =0x3464 \n"
"    MOV     R6, #0 \n"

"loc_FF88932C:\n"
"    LDR     R0, [R7, #4] \n"
"    MOV     R2, #0 \n"
"    MOV     R1, SP \n"
"    BL      sub_006B8458 /*_ReceiveMessageQueue*/ \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF88935C \n"
"    LDR     R2, =0x429 \n"
"    LDR     R1, =0xFF888C98 /*'SsShootTask.c'*/ \n"
"    MOV     R0, #0 \n"
"    BL      _DebugAssert \n"
"    BL      _ExitTask \n"
"    LDMFD   SP!, {R3-R7,PC} \n"

"loc_FF88935C:\n"
"    LDR     R0, [SP] \n"
"    LDR     R0, [R0] \n"
"    CMP     R0, #1 \n"
"    CMPNE   R0, #0x23 \n"
"    CMPNE   R0, #0x19 \n"
"    BLNE    sub_FF9946A0 \n"
"    LDR     R0, [SP] \n"
"    LDR     R1, [R0] \n"
"    CMP     R1, #0x25 \n"
"    ADDCC   PC, PC, R1, LSL#2 \n"
"    B       loc_FF8895B8 \n"
"    B       loc_FF88941C \n"
"    B       loc_FF889434 \n"
"    B       loc_FF889440 \n"
"    B       loc_FF889454 \n"
"    B       loc_FF88944C \n"
"    B       loc_FF889460 \n"
"    B       loc_FF889468 \n"
"    B       loc_FF889470 \n"
"    B       loc_FF88947C \n"
"    B       loc_FF8894A8 \n"
"    B       loc_FF889488 \n"
"    B       loc_FF889494 \n"
"    B       loc_FF88949C \n"
"    B       loc_FF8894B0 \n"
"    B       loc_FF8894B8 \n"
"    B       loc_FF8894C0 \n"
"    B       loc_FF8894C8 \n"
"    B       loc_FF8894D0 \n"
"    B       loc_FF8894DC \n"
"    B       loc_FF8894E4 \n"
"    B       loc_FF8894EC \n"
"    B       loc_FF8894F4 \n"
"    B       loc_FF8894FC \n"
"    B       loc_FF889504 \n"
"    B       loc_FF88950C \n"
"    B       loc_FF889514 \n"
"    B       loc_FF889520 \n"
"    B       loc_FF889528 \n"
"    B       loc_FF889530 \n"
"    B       loc_FF889538 \n"
"    B       loc_FF889540 \n"
"    B       loc_FF88954C \n"
"    B       loc_FF889554 \n"
"    B       loc_FF889560 \n"
"    B       loc_FF889598 \n"
"    B       loc_FF8895A4 \n"
"    B       loc_FF8895C8 \n"

"loc_FF88941C:\n"
"    BL      sub_FF889B2C \n"
"    BL      shooting_expo_param_override\n"    // added
"    BL      sub_FF886958 \n"
// try avoid intermittetant override failues on quick press, not needed?
//"    MOV     R0, #0\n"                          // added
//"    STR     R0, [R5,#0x28]\n"                  // added
"    LDR     R0, [R5, #0x28] \n"
"    CMP     R0, #0 \n"
"    BLNE    sub_FF99328C_my \n"  // --> Patched. Old value = 0xFF99328C.
"    B       loc_FF8895C8 \n"

"loc_FF889434:\n"
"    LDR     R0, [R0, #0x10] \n"
"    BL      sub_FF9930D4_my \n"  // --> Patched. Old value = 0xFF9930D4.
"    B       loc_FF8895C8 \n"

"loc_FF889440:\n"
"    MOV     R0, #1 \n"
"    BL      sub_FF889E88 \n"
"    B       loc_FF8895C8 \n"

"loc_FF88944C:\n"
"    BL      sub_FF8897A8 \n"
"    B       loc_FF889458 \n"

"loc_FF889454:\n"
"    BL      sub_FF889B08 \n"

"loc_FF889458:\n"
"    STR     R6, [R5, #0x28] \n"
"    B       loc_FF8895C8 \n"

"loc_FF889460:\n"
"    BL      sub_FF889B10 \n"
"    B       loc_FF8895C8 \n"

"loc_FF889468:\n"
"    BL      sub_FF889D4C \n"
"    B       loc_FF889480 \n"

"loc_FF889470:\n"
"    LDR     R0, [R0, #0x10] \n"
"    BL      sub_FF993328 \n"
"    B       loc_FF8895C8 \n"

"loc_FF88947C:\n"
"    BL      sub_FF889DE0 \n"

"loc_FF889480:\n"
"    BL      sub_FF886958 \n"
"    B       loc_FF8895C8 \n"

"loc_FF889488:\n"
"    LDR     R0, [R5, #0x50] \n"
"    BL      sub_FF88A46C \n"
"    B       loc_FF8895C8 \n"

"loc_FF889494:\n"
"    BL      sub_FF88A8A0 \n"
"    B       loc_FF8895C8 \n"

"loc_FF88949C:\n"
"    LDR     R0, [R0, #0xC] \n"
"    BL      sub_FF88A908 \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894A8:\n"
"    BL      sub_FF889B08 \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894B0:\n"
"    BL      sub_FF9925BC \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894B8:\n"
"    BL      sub_FF9927F8 \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894C0:\n"
"    BL      sub_FF9928B4 \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894C8:\n"
"    BL      sub_FF99298C \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894D0:\n"
"    MOV     R0, #0 \n"
"    BL      sub_FF992BF4 \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894DC:\n"
"    BL      sub_FF992D54 \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894E4:\n"
"    BL      sub_FF890258 \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894EC:\n"
"    BL      sub_FF890264 \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894F4:\n"
"    BL      sub_FF992DF0 \n"
"    B       loc_FF8895C8 \n"

"loc_FF8894FC:\n"
"    BL      sub_FF992E9C \n"
"    B       loc_FF8895C8 \n"

"loc_FF889504:\n"
"    BL      sub_FF889FF0 \n"
"    B       loc_FF8895C8 \n"

"loc_FF88950C:\n"
"    MOV     R0, #0 \n"
"    B       loc_FF889518 \n"

"loc_FF889514:\n"
"    LDR     R0, [R0, #0xC] \n"

"loc_FF889518:\n"
"    BL      sub_FF88A064 \n"
"    B       loc_FF8895C8 \n"

"loc_FF889520:\n"
"    BL      sub_FF992A5C \n"
"    B       loc_FF8895C8 \n"

"loc_FF889528:\n"
"    BL      sub_FF992A9C \n"
"    B       loc_FF8895C8 \n"

"loc_FF889530:\n"
"    BL      sub_FF88CE40 \n"
"    B       loc_FF8895C8 \n"

"loc_FF889538:\n"
"    BL      sub_FF88CF30 \n"
"    B       loc_FF8895C8 \n"

"loc_FF889540:\n"
"    LDR     R0, [R0, #0xC] \n"
"    BL      sub_FF992FAC \n"
"    B       loc_FF8895C8 \n"

"loc_FF88954C:\n"
"    BL      sub_FF993034 \n"
"    B       loc_FF8895C8 \n"

"loc_FF889554:\n"
"    BL      sub_FF88D0BC \n"
"    BL      sub_FF88CF88 \n"
"    B       loc_FF8895C8 \n"

"loc_FF889560:\n"
"    MOV     R0, #1 \n"
"    BL      sub_FF993BA0 \n"
"    MOV     R0, #1 \n"
"    BL      sub_FF993CCC \n"
"    LDR     R0, =0x1C4E4 \n"
"    LDRH    R0, [R0, #0x90] \n"
"    CMP     R0, #4 \n"
"    LDRNEH  R0, [R5] \n"
"    SUBNE   R1, R0, #0x8200 \n"
"    SUBNES  R1, R1, #0x31 \n"
"    BNE     loc_FF8895C8 \n"
"    BL      sub_FF88CF30 \n"
"    BL      sub_FF88D454 \n"
"    B       loc_FF8895C8 \n"

"loc_FF889598:\n"
"    MOV     R2, #0 \n"
"    MOV     R1, #0x10 \n"
"    B       loc_FF8895AC \n"

"loc_FF8895A4:\n"
"    MOV     R2, #0 \n"
"    MOV     R1, #0xF \n"

"loc_FF8895AC:\n"
"    MOV     R0, #0 \n"
"    BL      sub_FF88742C \n"
"    B       loc_FF8895C8 \n"

"loc_FF8895B8:\n"
"    LDR     R2, =0x54D \n"
"    LDR     R1, =0xFF888C98 /*'SsShootTask.c'*/ \n"
"    MOV     R0, #0 \n"
"    BL      _DebugAssert \n"

"loc_FF8895C8:\n"
"    LDR     R0, [SP] \n"
"    LDR     R1, [R0, #4] \n"
"    LDR     R0, [R7] \n"
"    BL      sub_006B81EC /*_SetEventFlag*/ \n"
"    LDR     R4, [SP] \n"
"    LDR     R0, [R4, #8] \n"
"    CMP     R0, #0 \n"
"    LDREQ   R2, =0x11E \n"
"    LDREQ   R1, =0xFF888C98 /*'SsShootTask.c'*/ \n"
"    BLEQ    _DebugAssert \n"
"    STR     R6, [R4, #8] \n"
"    B       loc_FF88932C \n"
);
}

/*************************************************************/
//** sub_FF99328C_my @ 0xFF99328C - 0xFF993324, length=39
void __attribute__((naked,noinline)) sub_FF99328C_my() {
asm volatile (
"    STMFD   SP!, {R4-R6,LR} \n"
"    BL      sub_FF888880 \n"
"    MOV     R4, R0 \n"
"    MOV     R0, #0xC \n"
"    BL      sub_FF88E938 \n"
"    LDR     R6, =0x7278 \n"
"    TST     R0, #1 \n"
"    MOV     R5, #1 \n"
"    BNE     loc_FF993320 \n"
"    BL      sub_FF88E994 \n"
"    TST     R0, #1 \n"
"    BNE     loc_FF993320 \n"
"    BL      sub_FF889B18 \n"
"    BL      sub_FF88AC30 \n"
"    MOV     R1, R4 \n"
"    BL      sub_FF88AC8C \n"
"    LDR     R0, =0x10E \n"
"    MOV     R2, #4 \n"
"    ADD     R1, R4, #0x30 \n"
"    BL      _SetPropertyCase \n"
"    MOV     R2, #4 \n"
"    ADD     R1, R4, #0x34 \n"
"    MOV     R0, #0x2C \n"
"    BL      _SetPropertyCase \n"
"    MOV     R2, #4 \n"
"    ADD     R1, R4, #8 \n"
"    MOV     R0, #0x3F \n"
"    BL      _SetPropertyCase \n"
"    BL      sub_FF993E8C \n"
"    MVN     R1, #0x1000 \n"
"    BL      sub_006B8234 /*_ClearEventFlag*/ \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAC7F58 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAC82DC_my \n"  // --> Patched. Old value = 0xFFAC82DC.
"    TST     R0, #1 \n"
"    LDMEQFD SP!, {R4-R6,PC} \n"

"loc_FF993320:\n"
"    STR     R5, [R6] \n"
"    LDMFD   SP!, {R4-R6,PC} \n"
);
}

/*************************************************************/
//** sub_FF9930D4_my @ 0xFF9930D4 - 0xFF99325C, length=99
void __attribute__((naked,noinline)) sub_FF9930D4_my() {
asm volatile (
"    STMFD   SP!, {R2-R6,LR} \n"
"    LDR     R6, =0x1C3E4 \n"
"    MOV     R5, R0 \n"
"    LDR     R0, [R6, #0x28] \n"
"    MOV     R4, #0 \n"
"    CMP     R0, #0 \n"
"    BEQ     loc_FF993120 \n"
"    LDR     R0, =0x7278 \n"
"    MOV     R2, R5 \n"
"    LDR     R0, [R0] \n"
"    MOV     R1, #1 \n"
"    CMP     R0, #0 \n"
"    MOVNE   R4, #0x1D \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF88742C \n"
"    MOV     R1, R4 \n"
"    MOV     R0, R5 \n"
"    BL      sub_FF994428 \n"
"    B       sub_FF993280 \n"

"loc_FF993120:\n"
"    BL      sub_FF88AC30 \n"
"    MOV     R1, R5 \n"
"    BL      sub_FF88AC8C \n"
"    LDR     R0, =0x10E \n"
"    MOV     R2, #4 \n"
"    ADD     R1, R5, #0x30 \n"
"    BL      _SetPropertyCase \n"
"    MOV     R2, #4 \n"
"    ADD     R1, R5, #0x34 \n"
"    MOV     R0, #0x2C \n"
"    BL      _SetPropertyCase \n"
"    MOV     R0, #0xC \n"
"    BL      sub_FF88E938 \n"
"    TST     R0, #1 \n"
"    BNE     loc_FF993168 \n"
"    BL      sub_FF88E994 \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF993170 \n"

"loc_FF993168:\n"
"    BL      sub_FF88720C \n"
"    MOV     R4, #1 \n"

"loc_FF993170:\n"
"    TST     R4, #1 \n"
"    BNE     sub_FF993264 \n"
"    BL      sub_FF993E8C \n"
"    MVN     R1, #0x1000 \n"
"    BL      sub_006B8234 /*_ClearEventFlag*/ \n"
"    MOV     R0, R5 \n"
"    BL      sub_FFAC75E0 \n"
"    TST     R0, #1 \n"
"    MOV     R4, R0 \n"
"    BNE     sub_FF993264 \n"
"    BL      sub_FF889B18 \n"
"    MOV     R0, R5 \n"
"    BL      sub_FFAC7F58 \n"
"    LDR     R0, [R6, #0x98] \n"
"    CMP     R0, #0 \n"
"    BEQ     loc_FF993244 \n"
"    LDR     R0, =0x1C4E4 \n"
"    LDRH    R0, [R0, #0x8E] \n"
"    CMP     R0, #3 \n"
"    LDRNE   R0, [R5, #8] \n"
"    CMPNE   R0, #1 \n"
"    BLS     loc_FF9931E4 \n"
"    BL      sub_FF993E8C \n"
"    LDR     R3, =0x10D \n"
"    LDR     R2, =0x3A98 \n"
"    STR     R3, [SP] \n"
"    LDR     R3, =0xFF9933BC /*'SsCaptureCtrl.c'*/ \n"
"    MOV     R1, #0x1000 \n"
"    BL      sub_FF88EC08 \n"

"loc_FF9931E4:\n"
"    MOV     R2, #4 \n"
"    ADD     R1, SP, #4 \n"
"    MOV     R0, #0x180 \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    LDRNE   R2, =0x111 \n"
"    LDRNE   R1, =0xFF9933BC /*'SsCaptureCtrl.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    LDR     R0, [SP, #4] \n"
"    CMP     R0, #0 \n"
"    BNE     loc_FF993224 \n"
"    BL      sub_FF993E8C \n"
"    MOV     R1, #0x1000 \n"
"    BL      sub_006B81EC /*_SetEventFlag*/ \n"
"    B       loc_FF993244 \n"

"loc_FF993224:\n"
"    BL      sub_FF993E8C \n"
"    MOV     R1, #0x1000 \n"
"    BL      sub_006B8234 /*_ClearEventFlag*/ \n"
"    LDR     R2, =0xFF9930C0 \n"
"    LDR     R0, [SP, #4] \n"
"    MOV     R3, #0x1000 \n"
"    MOV     R1, R2 \n"
"    BL      sub_FF8260F4 /*_SetTimerAfter*/ \n"

"loc_FF993244:\n"
"    LDR     R0, [R6, #0xA4] \n"
"    CMP     R0, #0 \n"
"    MOV     R0, R5 \n"
"    BEQ     loc_FF99325C \n"
"    BL      sub_FFAC86B0 \n"
"    B       sub_FF993280 \n"

"loc_FF99325C:\n"
"    BL      sub_FFAC82DC_my \n"  // --> Patched. Old value = 0xFFAC82DC.
"    LDR     PC, =0xFF993260 \n"  // Continue in firmware
);
}

/*************************************************************/
//** sub_FFAC82DC_my @ 0xFFAC82DC - 0xFFAC854C, length=157
void __attribute__((naked,noinline)) sub_FFAC82DC_my() {
asm volatile (
"    STMFD   SP!, {R2-R8,LR} \n"
"    MOV     R4, R0 \n"
"    BL      sub_FFAC7EC0 \n"
"    BL      sub_FF993958 \n"
"    LDR     R7, =0x1C3E4 \n"
"    LDR     R0, [R7, #0x184] \n"
"    CMP     R0, #2 \n"
"    BNE     loc_FFAC8318 \n"
"    ADD     R0, R7, #0x100 \n"
"    LDRH    R0, [R0, #0x8E] \n"
"    CMP     R0, #3 \n"
"    LDRNE   R0, [R4, #8] \n"
"    CMPNE   R0, #1 \n"
"    MOVLS   R0, #3 \n"
"    BLLS    sub_FF9195A0 \n"

"loc_FFAC8318:\n"
"    LDR     R0, =0x12F \n"
"    MOV     R2, #4 \n"
"    ADD     R1, SP, #4 \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    MOVNE   R2, #0x18C \n"
"    LDRNE   R1, =0xFFAC8560 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    LDR     R0, [SP, #4] \n"
"    AND     R0, R0, #0xFF00 \n"
"    CMP     R0, #0x600 \n"
"    LDRNE   R0, =0xFFAC7B84 \n"
"    LDREQ   R0, =0xFFAC82A4 \n"
"    MOVNE   R1, R4 \n"
"    MOVEQ   R1, #0 \n"
"    BL      sub_FF8C8870 \n"
"    BL      wait_until_remote_button_is_released\n" // added
"    BL      capt_seq_hook_set_nr\n"                 // added
"    MOV     R0, R4 \n"
"    BL      sub_FFAC7FE8 \n"
"    LDR     R1, =0xC54C \n"
"    MOV     R2, #4 \n"
"    MOV     R0, #0x8A \n"
"    BL      _GetPropertyCase \n"
"    TST     R0, #1 \n"
"    LDRNE   R2, =0x19B \n"
"    LDRNE   R1, =0xFFAC8560 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    BL      sub_FF88C0C4 \n"
"    BL      sub_FF97A9C0 \n"
"    MOV     R1, #0 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAC8658 \n"
"    MOV     R6, R0 \n"
"    LDR     R0, [SP, #4] \n"
"    LDR     R8, =0xC54C \n"
"    AND     R0, R0, #0xFF00 \n"
"    CMP     R0, #0x600 \n"
"    LDRH    R0, [R4, #0x18] \n"
"    LDRNE   R2, =0xFFAC7DAC \n"
"    LDREQ   R2, =0xFFAC7D30 \n"
"    CMP     R0, #0 \n"
"    BEQ     loc_FFAC83D4 \n"
"    CMP     R0, #1 \n"
"    BEQ     loc_FFAC83F8 \n"
"    CMP     R0, #4 \n"
"    BNE     loc_FFAC846C \n"

"loc_FFAC83D4:\n"
"    STR     R6, [SP] \n"
"    MOV     R3, R2 \n"
"    LDR     R1, [R4, #0x34] \n"
"    LDR     R2, [R8] \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAC7974 \n"
"    MOV     R5, R0 \n"
"    BL      sub_FF8C4FF4 \n"
"    B       loc_FFAC8480 \n"

"loc_FFAC83F8:\n"
"    STR     R6, [SP] \n"
"    MOV     R3, R2 \n"
"    LDR     R1, [R4, #0x34] \n"
"    LDR     R2, [R8] \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAC79F4 \n"
"    MOV     R5, R0 \n"
"    MOV     R1, #0 \n"
"    MOV     R0, #0x45 \n"
"    BL      sub_FF83209C \n"
"    TST     R5, #1 \n"
"    BNE     loc_FFAC8480 \n"
"    LDR     R0, =0xFFAC82A4 \n"
"    MOV     R1, #0 \n"
"    BL      sub_FF8C8870 \n"
"    MOV     R1, #1 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAC8658 \n"
"    MOV     R6, R0 \n"
"    LDR     R0, [R8] \n"
"    BL      sub_FFAC7E44 \n"
"    LDR     R1, [R4, #0x34] \n"
"    LDR     R2, [R8] \n"
"    MOV     R3, R6 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAC7A74 \n"
"    MOV     R5, R0 \n"
"    BL      sub_FFAC78FC \n"
"    B       loc_FFAC8480 \n"

"loc_FFAC846C:\n"
"    LDR     R2, =0x1D5 \n"
"    LDR     R1, =0xFFAC8560 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOV     R0, #0 \n"
"    BL      _DebugAssert \n"
"    MOV     R5, #0x1D \n"

"loc_FFAC8480:\n"
"    BL      sub_FF97A9D8 \n"
"    LDR     R8, =0xFFAC82A4 \n"
"    TST     R5, #1 \n"
"    BNE     loc_FFAC8500 \n"
"    LDR     R0, [R7, #0xF8] \n"
"    CMP     R0, #0 \n"
"    BNE     loc_FFAC84B8 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF994C34 \n"
"    TST     R0, #1 \n"
"    LDRNE   R2, =0x1EF \n"
"    LDRNE   R1, =0xFFAC8560 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    BL      capt_seq_hook_raw_here \n"         // added

"loc_FFAC84B8:\n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAC80D0 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FFAC8088 \n"
"    CMP     R6, R8 \n"
"    BEQ     loc_FFAC8500 \n"
"    BL      sub_FF993E8C \n"
"    MOV     R3, #0x1FC \n"
"    STR     R3, [SP] \n"
"    LDR     R2, =0x3A98 \n"
"    LDR     R3, =0xFFAC8560 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOV     R1, #4 \n"
"    BL      sub_FF88EC08 \n"
"    CMP     R0, #0 \n"
"    MOVNE   R2, #0x1FC \n"
"    LDRNE   R1, =0xFFAC8560 /*'SsStandardCaptureSeq.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"

"loc_FFAC8500:\n"
"    MOV     R2, R4 \n"
"    MOV     R1, #1 \n"
"    MOV     R0, R5 \n"
"    BL      sub_FF88742C \n"
"    LDR     R0, [R7, #0x28] \n"
"    CMP     R0, #0 \n"
"    BEQ     loc_FFAC8534 \n"
"    SUBS    R1, R6, R8 \n"
"    MOVNE   R1, #1 \n"
"    MOV     R2, R5 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF9943C0 \n"
"    B       loc_FFAC8548 \n"

"loc_FFAC8534:\n"
"    SUBS    R1, R6, R8 \n"
"    MOVNE   R1, #1 \n"
"    MOV     R2, R5 \n"
"    MOV     R0, R4 \n"
"    BL      sub_FF994354 \n"

"loc_FFAC8548:\n"
"    MOV     R0, R5 \n"
"    LDMFD   SP!, {R2-R8,PC} \n"
"    .ltorg\n"         // added
);
}

/*************************************************************/
//** exp_drv_task @ 0xFF8D7434 - 0xFF8D7AB8, length=418
void __attribute__((naked,noinline)) exp_drv_task() {
asm volatile (
"    STMFD   SP!, {R4-R9,LR} \n"
"    SUB     SP, SP, #0x2C \n"
"    LDR     R6, =0x4300 \n"
"    LDR     R7, =0xBB8 \n"
"    LDR     R4, =0x5B404 \n"
"    MOV     R0, #0 \n"
"    ADD     R5, SP, #0x1C \n"
"    STR     R0, [SP, #0xC] \n"

"loc_FF8D7454:\n"
"    LDR     R0, [R6, #0x20] \n"
"    MOV     R2, #0 \n"
"    ADD     R1, SP, #0x28 \n"
"    BL      sub_006B8458 /*_ReceiveMessageQueue*/ \n"
"    LDR     R0, [SP, #0xC] \n"
"    CMP     R0, #1 \n"
"    BNE     loc_FF8D74A0 \n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R0, [R0] \n"
"    CMP     R0, #0x14 \n"
"    CMPNE   R0, #0x15 \n"
"    CMPNE   R0, #0x16 \n"
"    CMPNE   R0, #0x17 \n"
"    BEQ     loc_FF8D7604 \n"
"    CMP     R0, #0x2A \n"
"    BEQ     loc_FF8D7588 \n"
"    ADD     R1, SP, #0xC \n"
"    MOV     R0, #0 \n"
"    BL      sub_FF8D73D4 \n"

"loc_FF8D74A0:\n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R1, [R0] \n"
"    CMP     R1, #0x30 \n"
"    BNE     loc_FF8D74CC \n"
"    BL      sub_FF8D8A80 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R1, #1 \n"
"    BL      sub_006B81EC /*_SetEventFlag*/ \n"
"    BL      _ExitTask \n"
"    ADD     SP, SP, #0x2C \n"
"    LDMFD   SP!, {R4-R9,PC} \n"

"loc_FF8D74CC:\n"
"    CMP     R1, #0x2F \n"
"    BNE     loc_FF8D74E8 \n"
"    LDR     R2, [R0, #0xA8]! \n"
"    LDR     R1, [R0, #4] \n"
"    MOV     R0, R1 \n"
"    BLX     R2 \n"
"    B       loc_FF8D7AB0 \n"

"loc_FF8D74E8:\n"
"    CMP     R1, #0x28 \n"
"    BNE     loc_FF8D7538 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R1, #0x80 \n"
"    BL      sub_006B8234 /*_ClearEventFlag*/ \n"
"    LDR     R0, =0xFF8D2810 \n"
"    MOV     R1, #0x80 \n"
"    BL      sub_FF8841E8 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R2, R7 \n"
"    MOV     R1, #0x80 \n"
"    BL      sub_006B8120 /*_WaitForAllEventFlag*/ \n"
"    TST     R0, #1 \n"
"    LDRNE   R2, =0x170B \n"
"    BNE     loc_FF8D75F4 \n"

"loc_FF8D7524:\n"
"    LDR     R1, [SP, #0x28] \n"
"    LDR     R0, [R1, #0xAC] \n"
"    LDR     R1, [R1, #0xA8] \n"
"    BLX     R1 \n"
"    B       loc_FF8D7AB0 \n"

"loc_FF8D7538:\n"
"    CMP     R1, #0x29 \n"
"    BNE     loc_FF8D7580 \n"
"    ADD     R1, SP, #0xC \n"
"    BL      sub_FF8D73D4 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R1, #0x100 \n"
"    BL      sub_006B8234 /*_ClearEventFlag*/ \n"
"    LDR     R0, =0xFF8D2820 \n"
"    MOV     R1, #0x100 \n"
"    BL      sub_FF8843F8 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R2, R7 \n"
"    MOV     R1, #0x100 \n"
"    BL      sub_006B8120 /*_WaitForAllEventFlag*/ \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF8D7524 \n"
"    LDR     R2, =0x1715 \n"
"    B       loc_FF8D75F4 \n"

"loc_FF8D7580:\n"
"    CMP     R1, #0x2A \n"
"    BNE     loc_FF8D7598 \n"

"loc_FF8D7588:\n"
"    LDR     R0, [SP, #0x28] \n"
"    ADD     R1, SP, #0xC \n"
"    BL      sub_FF8D73D4 \n"
"    B       loc_FF8D7524 \n"

"loc_FF8D7598:\n"
"    CMP     R1, #0x2D \n"
"    BNE     loc_FF8D75B0 \n"
"    BL      sub_FF8BFD88 \n"
"    BL      sub_FF8C0BEC \n"
"    BL      sub_FF8C06CC \n"
"    B       loc_FF8D7524 \n"

"loc_FF8D75B0:\n"
"    CMP     R1, #0x2E \n"
"    BNE     loc_FF8D7604 \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R1, #4 \n"
"    BL      sub_006B8234 /*_ClearEventFlag*/ \n"
"    LDR     R1, =0xFF8D2840 \n"
"    LDR     R0, =0xFFFFF400 \n"
"    MOV     R2, #4 \n"
"    BL      sub_FF8D8AE4 \n"
"    BL      sub_FF8BFA1C \n"
"    LDR     R0, [R6, #0x1C] \n"
"    MOV     R2, R7 \n"
"    MOV     R1, #4 \n"
"    BL      sub_006B8034 /*_WaitForAnyEventFlag*/ \n"
"    TST     R0, #1 \n"
"    BEQ     loc_FF8D7524 \n"
"    LDR     R2, =0x174D \n"

"loc_FF8D75F4:\n"
"    LDR     R1, =0xFF8D2FC4 /*'ExpDrv.c'*/ \n"
"    MOV     R0, #0 \n"
"    BL      _DebugAssert \n"
"    B       loc_FF8D7524 \n"

"loc_FF8D7604:\n"
"    LDR     R0, [SP, #0x28] \n"
"    MOV     R8, #1 \n"
"    LDR     R1, [R0] \n"
"    CMP     R1, #0x12 \n"
"    CMPNE   R1, #0x13 \n"
"    BNE     loc_FF8D766C \n"
"    LDR     R1, [R0, #0x94] \n"
"    ADD     R1, R1, R1, LSL#1 \n"
"    ADD     R1, R0, R1, LSL#2 \n"
"    SUB     R1, R1, #8 \n"
"    LDMIA   R1, {R2,R3,R9} \n"
"    STMIA   R5, {R2,R3,R9} \n"
"    BL      sub_FF8D5838 \n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R3, [R0, #0xA8] \n"
"    LDR     R2, [R0, #0xAC] \n"
"    ADD     R0, R0, #4 \n"
"    BLX     R3 \n"
"    LDR     R0, [SP, #0x28] \n"
"    BL      sub_FF8D8DC0 \n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R2, [R0, #0xB4] \n"
"    LDR     R3, [R0, #0xB0] \n"
"    B       loc_FF8D7974 \n"

"loc_FF8D766C:\n"
"    CMP     R1, #0x14 \n"
"    CMPNE   R1, #0x15 \n"
"    CMPNE   R1, #0x16 \n"
"    CMPNE   R1, #0x17 \n"
"    BNE     loc_FF8D7714 \n"
"    ADD     R3, SP, #0xC \n"
"    MOV     R2, SP \n"
"    ADD     R1, SP, #0x1C \n"
"    BL      sub_FF8D5AA8 \n"
"    CMP     R0, #1 \n"
"    MOV     R9, R0 \n"
"    CMPNE   R9, #5 \n"
"    BNE     loc_FF8D76C0 \n"
"    LDR     R0, [SP, #0x28] \n"
"    MOV     R2, R9 \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R12, [R0, #0xA8] \n"
"    LDR     R3, [R0, #0xAC] \n"
"    ADD     R0, R0, #4 \n"
"    BLX     R12 \n"
"    B       loc_FF8D76F8 \n"

"loc_FF8D76C0:\n"
"    LDR     R0, [SP, #0x28] \n"
"    CMP     R9, #2 \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R12, [R0, #0xA8] \n"
"    LDR     R3, [R0, #0xAC] \n"
"    CMPNE   R9, #6 \n"
"    MOV     R2, R9 \n"
"    ADD     R0, R0, #4 \n"
"    BNE     loc_FF8D770C \n"
"    BLX     R12 \n"
"    LDR     R0, [SP, #0x28] \n"
"    MOV     R2, SP \n"
"    ADD     R1, SP, #0x1C \n"
"    BL      sub_FF8D70EC \n"

"loc_FF8D76F8:\n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R2, [SP, #0xC] \n"
"    MOV     R1, R9 \n"
"    BL      sub_FF8D736C \n"
"    B       loc_FF8D797C \n"

"loc_FF8D770C:\n"
"    BLX     R12 \n"
"    B       loc_FF8D797C \n"

"loc_FF8D7714:\n"
"    CMP     R1, #0x24 \n"
"    CMPNE   R1, #0x25 \n"
"    BNE     loc_FF8D7760 \n"
"    LDR     R1, [R0, #0x94] \n"
"    ADD     R1, R1, R1, LSL#1 \n"
"    ADD     R1, R0, R1, LSL#2 \n"
"    SUB     R1, R1, #8 \n"
"    LDMIA   R1, {R2,R3,R9} \n"
"    STMIA   R5, {R2,R3,R9} \n"
"    BL      sub_FF8D4754 \n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R3, [R0, #0xA8] \n"
"    LDR     R2, [R0, #0xAC] \n"
"    ADD     R0, R0, #4 \n"
"    BLX     R3 \n"
"    LDR     R0, [SP, #0x28] \n"
"    BL      sub_FF8D4BA4 \n"
"    B       loc_FF8D797C \n"

"loc_FF8D7760:\n"
"    ADD     R1, R0, #4 \n"
"    LDMIA   R1, {R2,R3,R9} \n"
"    STMIA   R5, {R2,R3,R9} \n"
"    LDR     R1, [R0] \n"
"    CMP     R1, #0x28 \n"
"    ADDCC   PC, PC, R1, LSL#2 \n"
"    B       loc_FF8D7964 \n"
"    B       loc_FF8D781C \n"
"    B       loc_FF8D781C \n"
"    B       loc_FF8D7824 \n"
"    B       loc_FF8D782C \n"
"    B       loc_FF8D782C \n"
"    B       loc_FF8D782C \n"
"    B       loc_FF8D781C \n"
"    B       loc_FF8D7824 \n"
"    B       loc_FF8D782C \n"
"    B       loc_FF8D782C \n"
"    B       loc_FF8D7844 \n"
"    B       loc_FF8D7844 \n"
"    B       loc_FF8D7950 \n"
"    B       loc_FF8D7958 \n"
"    B       loc_FF8D7958 \n"
"    B       loc_FF8D7958 \n"
"    B       loc_FF8D7958 \n"
"    B       loc_FF8D7960 \n"
"    B       loc_FF8D7964 \n"
"    B       loc_FF8D7964 \n"
"    B       loc_FF8D7964 \n"
"    B       loc_FF8D7964 \n"
"    B       loc_FF8D7964 \n"
"    B       loc_FF8D7964 \n"
"    B       loc_FF8D7834 \n"
"    B       loc_FF8D783C \n"
"    B       loc_FF8D783C \n"
"    B       loc_FF8D783C \n"
"    B       loc_FF8D7850 \n"
"    B       loc_FF8D7850 \n"
"    B       loc_FF8D7858 \n"
"    B       loc_FF8D7890 \n"
"    B       loc_FF8D78C8 \n"
"    B       loc_FF8D7900 \n"
"    B       loc_FF8D7938 \n"
"    B       loc_FF8D7938 \n"
"    B       loc_FF8D7964 \n"
"    B       loc_FF8D7964 \n"
"    B       loc_FF8D7940 \n"
"    B       loc_FF8D7948 \n"

"loc_FF8D781C:\n"
"    BL      sub_FF8D2E44 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7824:\n"
"    BL      sub_FF8D3114 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D782C:\n"
"    BL      sub_FF8D3354 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7834:\n"
"    BL      sub_FF8D369C \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D783C:\n"
"    BL      sub_FF8D38CC \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7844:\n"
"    BL      sub_FF8D3CBC_my \n"  // --> Patched. Old value = 0xFF8D3CBC.
"    MOV     R8, #0 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7850:\n"
"    BL      sub_FF8D3E98 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7858:\n"
"    LDRH    R1, [R0, #4] \n"
"    STRH    R1, [SP, #0x1C] \n"
"    LDRH    R1, [R4, #2] \n"
"    STRH    R1, [SP, #0x1E] \n"
"    LDRH    R1, [R4, #4] \n"
"    STRH    R1, [SP, #0x20] \n"
"    LDRH    R1, [R4, #6] \n"
"    STRH    R1, [SP, #0x22] \n"
"    LDRH    R1, [R0, #0xC] \n"
"    STRH    R1, [SP, #0x24] \n"
"    LDRH    R1, [R4, #0xA] \n"
"    STRH    R1, [SP, #0x26] \n"
"    BL      sub_FF8D43DC \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7890:\n"
"    LDRH    R1, [R0, #4] \n"
"    STRH    R1, [SP, #0x1C] \n"
"    LDRH    R1, [R4, #2] \n"
"    STRH    R1, [SP, #0x1E] \n"
"    LDRH    R1, [R4, #4] \n"
"    STRH    R1, [SP, #0x20] \n"
"    LDRH    R1, [R4, #6] \n"
"    STRH    R1, [SP, #0x22] \n"
"    LDRH    R1, [R4, #8] \n"
"    STRH    R1, [SP, #0x24] \n"
"    LDRH    R1, [R4, #0xA] \n"
"    STRH    R1, [SP, #0x26] \n"
"    BL      sub_FF8D8B30 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D78C8:\n"
"    LDRH    R1, [R4] \n"
"    STRH    R1, [SP, #0x1C] \n"
"    LDRH    R1, [R0, #6] \n"
"    STRH    R1, [SP, #0x1E] \n"
"    LDRH    R1, [R4, #4] \n"
"    STRH    R1, [SP, #0x20] \n"
"    LDRH    R1, [R4, #6] \n"
"    STRH    R1, [SP, #0x22] \n"
"    LDRH    R1, [R4, #8] \n"
"    STRH    R1, [SP, #0x24] \n"
"    LDRH    R1, [R4, #0xA] \n"
"    STRH    R1, [SP, #0x26] \n"
"    BL      sub_FF8D8C6C \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7900:\n"
"    LDRH    R1, [R4] \n"
"    STRH    R1, [SP, #0x1C] \n"
"    LDRH    R1, [R4, #2] \n"
"    STRH    R1, [SP, #0x1E] \n"
"    LDRH    R1, [R4, #4] \n"
"    STRH    R1, [SP, #0x20] \n"
"    LDRH    R1, [R4, #6] \n"
"    STRH    R1, [SP, #0x22] \n"
"    LDRH    R1, [R0, #0xC] \n"
"    STRH    R1, [SP, #0x24] \n"
"    LDRH    R1, [R4, #0xA] \n"
"    STRH    R1, [SP, #0x26] \n"
"    BL      sub_FF8D8D18 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7938:\n"
"    BL      sub_FF8D44F0 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7940:\n"
"    BL      sub_FF8D4CBC \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7948:\n"
"    BL      sub_FF8D5064 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7950:\n"
"    BL      sub_FF8D52D4 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7958:\n"
"    BL      sub_FF8D54A0 \n"
"    B       loc_FF8D7964 \n"

"loc_FF8D7960:\n"
"    BL      sub_FF8D5618 \n"

"loc_FF8D7964:\n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R1, [R0, #0x94] \n"
"    LDR     R2, [R0, #0xAC] \n"
"    LDR     R3, [R0, #0xA8] \n"

"loc_FF8D7974:\n"
"    ADD     R0, R0, #4 \n"
"    BLX     R3 \n"

"loc_FF8D797C:\n"
"    LDR     R0, [SP, #0x28] \n"
"    LDR     R0, [R0] \n"
"    CMP     R0, #0x10 \n"
"    BEQ     loc_FF8D79B4 \n"
"    BGT     loc_FF8D79A4 \n"
"    CMP     R0, #1 \n"
"    CMPNE   R0, #4 \n"
"    CMPNE   R0, #0xE \n"
"    BNE     loc_FF8D79E8 \n"
"    B       loc_FF8D79B4 \n"

"loc_FF8D79A4:\n"
"    CMP     R0, #0x13 \n"
"    CMPNE   R0, #0x17 \n"
"    CMPNE   R0, #0x1A \n"
"    BNE     loc_FF8D79E8 \n"

"loc_FF8D79B4:\n"
"    LDRSH   R0, [R4] \n"
"    CMN     R0, #0xC00 \n"
"    LDRNESH R1, [R4, #8] \n"
"    CMNNE   R1, #0xC00 \n"
"    STRNEH  R0, [SP, #0x1C] \n"
"    STRNEH  R1, [SP, #0x24] \n"
"    BNE     loc_FF8D79E8 \n"
"    ADD     R0, SP, #0x10 \n"
"    BL      sub_FF8D8FE4 /*_get_current_exp*/ \n"
"    LDRH    R0, [SP, #0x10] \n"
"    STRH    R0, [SP, #0x1C] \n"
"    LDRH    R0, [SP, #0x18] \n"
"    STRH    R0, [SP, #0x24] \n"

"loc_FF8D79E8:\n"
"    LDR     R0, [SP, #0x28] \n"
"    CMP     R8, #1 \n"
"    BNE     loc_FF8D7A38 \n"
"    LDR     R1, [R0, #0x94] \n"
"    MOV     R2, #0xC \n"
"    ADD     R1, R1, R1, LSL#1 \n"
"    ADD     R0, R0, R1, LSL#2 \n"
"    SUB     R8, R0, #8 \n"
"    LDR     R0, =0x5B404 \n"
"    ADD     R1, SP, #0x1C \n"
"    BL      sub_006BCD9C \n"
"    LDR     R0, =0x5B410 \n"
"    MOV     R2, #0xC \n"
"    ADD     R1, SP, #0x1C \n"
"    BL      sub_006BCD9C \n"
"    LDR     R0, =0x5B41C \n"
"    MOV     R2, #0xC \n"
"    MOV     R1, R8 \n"
"    BL      sub_006BCD9C \n"
"    B       loc_FF8D7AB0 \n"

"loc_FF8D7A38:\n"
"    LDR     R0, [R0] \n"
"    MOV     R3, #1 \n"
"    CMP     R0, #0xB \n"
"    BNE     loc_FF8D7A7C \n"
"    MOV     R2, #0 \n"
"    STRD    R2, [SP] \n"
"    MOV     R2, R3 \n"
"    MOV     R1, R3 \n"
"    MOV     R0, #0 \n"
"    BL      sub_FF8D2C10 \n"
"    MOV     R3, #1 \n"
"    MOV     R2, #0 \n"
"    STRD    R2, [SP] \n"
"    MOV     R2, R3 \n"
"    MOV     R1, R3 \n"
"    MOV     R0, #0 \n"
"    B       loc_FF8D7AAC \n"

"loc_FF8D7A7C:\n"
"    MOV     R2, #1 \n"
"    STRD    R2, [SP] \n"
"    MOV     R3, R2 \n"
"    MOV     R1, R2 \n"
"    MOV     R0, R2 \n"
"    BL      sub_FF8D2C10 \n"
"    MOV     R3, #1 \n"
"    MOV     R2, R3 \n"
"    MOV     R1, R3 \n"
"    MOV     R0, R3 \n"
"    STR     R3, [SP] \n"
"    STR     R3, [SP, #4] \n"

"loc_FF8D7AAC:\n"
"    BL      sub_FF8D2D8C \n"

"loc_FF8D7AB0:\n"
"    LDR     R0, [SP, #0x28] \n"
"    BL      sub_FF8D8A80 \n"
"    B       loc_FF8D7454 \n"
);
}

/*************************************************************/
//** sub_FF8D3CBC_my @ 0xFF8D3CBC - 0xFF8D3D80, length=50
void __attribute__((naked,noinline)) sub_FF8D3CBC_my() {
asm volatile (
"    STMFD   SP!, {R4-R8,LR} \n"
"    LDR     R7, =0x4300 \n"
"    MOV     R4, R0 \n"
"    LDR     R0, [R7, #0x1C] \n"
"    MOV     R1, #0x3E \n"
"    BL      sub_006B8234 /*_ClearEventFlag*/ \n"
"    MOV     R2, #0 \n"
"    LDRSH   R0, [R4, #4] \n"
"    MOV     R3, #1 \n"
"    MOV     R1, R2 \n"
"    BL      sub_FF8D28A8 \n"
"    MOV     R6, R0 \n"
"    LDRSH   R0, [R4, #6] \n"
"    BL      sub_FF8D2A70 \n"
"    LDRSH   R0, [R4, #8] \n"
"    BL      sub_FF8D2AC8 \n"
"    LDRSH   R0, [R4, #0xA] \n"
"    BL      sub_FF8D2B20 \n"
"    LDRSH   R0, [R4, #0xC] \n"
"    MOV     R1, #0 \n"
"    BL      sub_FF8D2B78 \n"
"    MOV     R5, R0 \n"
"    LDR     R0, [R4] \n"
"    LDR     R8, =0x5B41C \n"
"    CMP     R0, #0xB \n"
"    MOVEQ   R6, #0 \n"
"    MOVEQ   R5, R6 \n"
"    BEQ     loc_FF8D3D54 \n"
"    CMP     R6, #1 \n"
"    BNE     loc_FF8D3D54 \n"
"    LDRSH   R0, [R4, #4] \n"
"    LDR     R1, =0xFF8D2800 \n"
"    MOV     R2, #2 \n"
"    BL      sub_FF884270 \n"
"    STRH    R0, [R4, #4] \n"
"    MOV     R0, #0 \n"
"    STR     R0, [R7, #0x28] \n"
"    B       loc_FF8D3D5C \n"

"loc_FF8D3D54:\n"
"    LDRH    R0, [R8] \n"
"    STRH    R0, [R4, #4] \n"

"loc_FF8D3D5C:\n"
"    CMP     R5, #1 \n"
"    LDRNEH  R0, [R8, #8] \n"
"    BNE     loc_FF8D3D78 \n"
"    LDRSH   R0, [R4, #0xC] \n"
"    LDR     R1, =0xFF8D2884 \n"
"    MOV     R2, #0x20 \n"
"    BL      sub_FF8D8AEC \n"

"loc_FF8D3D78:\n"
"    STRH    R0, [R4, #0xC] \n"
"    LDRSH   R0, [R4, #6] \n"
"    BL      sub_FF8BFA94_my \n"  // --> Patched. Old value = 0xFF8BFA94.
"    LDR     PC, =0xFF8D3D84 \n"  // Continue in firmware
);
}

/*************************************************************/
//** sub_FF8BFA94_my @ 0xFF8BFA94 - 0xFF8BFB08, length=30
void __attribute__((naked,noinline)) sub_FF8BFA94_my() {
asm volatile (
"    STMFD   SP!, {R4-R6,LR} \n"
"    LDR     R5, =0x3F14 \n"
"    MOV     R4, R0 \n"
"    LDR     R0, [R5, #4] \n"
"    CMP     R0, #1 \n"
"    MOVNE   R2, #0x168 \n"
"    LDRNE   R1, =0xFF8BF844 /*'Shutter.c'*/ \n"
"    MOVNE   R0, #0 \n"
"    BLNE    _DebugAssert \n"
"    CMN     R4, #0xC00 \n"
"    LDREQSH R4, [R5, #2] \n"
"    CMN     R4, #0xC00 \n"
"    LDREQ   R2, =0x16E \n"
"    LDREQ   R1, =0xFF8BF844 /*'Shutter.c'*/ \n"
"    MOVEQ   R0, #0 \n"
"    STRH    R4, [R5, #2] \n"
"    BLEQ    _DebugAssert \n"
"    MOV     R0, R4 \n"
"    BL      apex2us \n"  // --> Patched. Old value = _apex2us.
"    MOV     R4, R0 \n"
//"  BL      _sub_FF918CD0 \n"  // --> Nullsub call removed.
"    MOV     R0, R4 \n"
"    BL      sub_FF91BC5C \n"
"    TST     R0, #1 \n"
"    LDMEQFD SP!, {R4-R6,PC} \n"
"    LDMFD   SP!, {R4-R6,LR} \n"
"    LDR     R2, =0x173 \n"
"    LDR     R1, =0xFF8BF844 /*'Shutter.c'*/ \n"
"    MOV     R0, #0 \n"
"    B       _DebugAssert \n"
);
}
